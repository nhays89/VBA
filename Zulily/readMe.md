# VBA 
This Macro was designed to improve the accuracy, functionality and speed of all variance reports created for Zulily's Vendor Operations Team. 

To run the macro's first be sure to pull the sample data.xlsm into a macro enabled excel spreadsheet.Once the data is in the Excel Spreadsheet the appropriate macro can be activated by using its shortcut key combination listed below. 

In the developer ribbon, you will notice 2 modules. Each module extends the same goal: transfer shortages into overage's. Each module is used in different circumstances:

The first module is used when manual P.O's are created by a vendor operations specialist to group existing overage's that were miss-interpreted by the database as shortages. These overage's are indicated with a blank P.O Push date (which makes sense because the items were never actually ordered on the original P.O date). So for each record that contains an empty push date its value is transferred from the "P.O shortage" field to the "P.O Overage" field. In this file, sub Main() calls sub FindRange() which searches for the field named “PO Pushed”. Control returns to main and then sub Formatter() is called, which, as the name suggest, formats the existing data into Zulily-specific formatting scheme (vendor name, P.O #, Product ID, SKU, Vendor SKU, Desc., Size, Cost, Shorted %, P.O qty, rcvd qty, P.O under, P.O over). For instance, some fields are irrelevant, and subsequently deleted by the macro. 

* note: The shortcut key for sub Formatter is crtl + shift + "V". 

Once the data is formatted then and only then the second module (sub Matcher()) can be run. The goal of this module is the exact same as the first module, except it compares product ID's from the ROM data to the current variance report product list to find which records need to have adjustments made. By adjustments, I am referring to transfers, such as shortages into overages, or overage's that need to be inserted from the ROM into the variance report. The program logic is as follows. First, the data from the ROM is imported into a worksheet adjacent to the variance report data (so "Sheets2"). It contains two fields of interest, "product ID" and "overage qty". The program oscillates back and forth between the two sheets to find a product match. It looks only in the fields designated as "product ID". If a match is found, the overage quantity from Sheet2 is transferred to the variance report (Sheet1) in the "overage qty" field, and the process repeats itself until all the product ID's have been searched. 
* note: the shortcut key for sub Matcher is crtl + shift + "N".
